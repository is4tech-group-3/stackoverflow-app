<div class="flex flex-col gap-6 h-full lg:flex-row">
  <div
    class="flex flex-col justify-between bg-white o p-4 w-full lg:w-80 rounded-lg shadow-[0_2px_10px_rgba(0,0,0,0.1)]"
  >
    <div class="relative">
      <label class="text-gray-800 font-semibold text-sm block" for="search">
        Busar
      </label>
      <div class="relative flex items-center group">
        <input
          id="search"
          type="text"
          class="w-full bg-transparent text-sm border-b border-gray-300 focus:border-dark-gunmetal px-2 py-3 outline-none"
          placeholder="Buscar usuario"
        />
        <div
          class="w-[18px] h-[18px] absolute right-4 text-gray-300 group-focus-within:text-dark-gunmetal"
        >
          <mat-icon aria-label="search icon">search</mat-icon>
        </div>
      </div>
    </div>

    <ul class="space-y-6 w-full mt-8 overflow-auto">
      <li
        *ngFor="let user of users"
        class="w-full p-3 hover:bg-gray-200 rounded-lg transition-all flex justify-between"
      >
        <button (click)="setUser(user.id)" class="block">
          <div class="flex items-center space-x-4">
            <ng-container *ngIf="user.image; else avatarTemplate">
              <img
                [src]="user.image"
                alt="{{ user.name }} {{ user.surname }}"
                class="w-10 h-10 rounded-full object-cover"
              />
            </ng-container>
            <ng-template #avatarTemplate>
              <ngx-avatars
                name="{{ user.name }} {{ user.surname }}"
                size="40"
                [textSizeRatio]="2"
              ></ngx-avatars>
            </ng-template>

            <div>
              <p class="text-sm text-left font-semibold text-gray-900">
                {{ user.name }} {{ user.surname }}
              </p>
              <p class="text-xs text-left text-gray-500">{{ user.email }}</p>
            </div>
          </div>
        </button>
        <button
          (click)="handlerDeleteUser(user.id)"
          [ngClass]="{
            'text-emerald-400': user.status,
            'text-rose-500': !user.status
          }"
        >
          <mat-icon aria-label="delete icon">{{
            user.status ? 'toggle_on' : 'toggle_off'
          }}</mat-icon>
        </button>
      </li>
    </ul>

    <mat-paginator
      class="w-full mt-auto"
      [hidePageSize]="true"
      [length]="100"
      [pageSize]="10"
    />
  </div>

  <div class="w-full flex-1 rounded-lg">
    <div class="flex flex-col gap-6 h-full">
      <div
        class="p-8 rounded-lg grid content-center row-span-1 col-span-2 shadow-[0_2px_10px_rgba(0,0,0,0.1)]"
      >
        <form [formGroup]="userForm" (submit)="onSubmit()" class="w-full">
          <div class="grid lg:grid-cols-3 gap-4">
            <div class="col-span-1 flex flex-col items-center">
              <h2 class="text-gray-800 font-semibold text-lg block">
                {{ 'input.photoProfile.label' | translate }}
              </h2>
              <div class="relative w-32 h-32 mx-auto group">
                <label for="image" class="w-full h-full cursor-pointer">
                  <img
                    class="w-full h-full rounded-full border border-collapse border-sunset-orange-500"
                    [src]="
                      userForm.get('image')?.value
                        ? userForm.get('image')?.value
                        : 'https://www.shutterstock.com/image-vector/blank-avatar-photo-place-holder-600nw-1095249842.jpg'
                    "
                    alt="profile"
                  />
                  <mat-icon
                    class="absolute top-0 left-0 text-4xl w-full h-full flex justify-center items-center rounded-full cursor-pointer opacity-0 group-hover:opacity-100 transition-opacity duration-500 bg-gray-200 bg-opacity-60"
                    aria-label="Upload icon"
                    >upload</mat-icon
                  >
                </label>
                <input
                  id="image"
                  type="file"
                  class="hidden"
                  multiple="multiple"
                />
              </div>
            </div>

            <div class="lg:col-span-2 grid lg:grid-cols-2 gap-4">
              <div class="relative">
                <label
                  class="text-gray-800 font-semibold text-sm block"
                  for="name"
                >
                  {{ 'input.name.label' | translate }}
                </label>
                <div class="relative flex items-center group">
                  <input
                    id="name"
                    formControlName="name"
                    type="text"
                    class="w-full bg-transparent text-sm border-b border-gray-300 focus:border-dark-gunmetal px-2 py-3 outline-none"
                    placeholder="{{ 'input.name.placeholder' | translate }}"
                  />
                  <div
                    class="w-[18px] h-[18px] absolute right-4 text-gray-300 group-focus-within:text-dark-gunmetal"
                  >
                    <mat-icon aria-label="name icon">person_add</mat-icon>
                  </div>
                </div>
                <p
                  *ngIf="
                    userForm.get('name')?.errors &&
                    (userForm.get('name')?.touched ||
                      userForm.get('name')?.dirty)
                  "
                  class="absolute w-full text-red-500 text-xs text-center font-medium mt-1 h-5"
                >
                  {{ getErrorMessage('name') }}
                </p>
              </div>

              <div class="relative">
                <label
                  class="text-gray-800 font-semibold text-sm block"
                  for="surname"
                >
                  {{ 'input.surname.label' | translate }}
                </label>
                <div class="relative flex items-center group">
                  <input
                    id="surname"
                    formControlName="surname"
                    type="text"
                    class="w-full bg-transparent text-sm border-b border-gray-300 focus:border-dark-gunmetal px-2 py-3 outline-none"
                    placeholder="{{ 'input.surname.placeholder' | translate }}"
                  />
                  <div
                    class="w-[18px] h-[18px] absolute right-4 text-gray-300 group-focus-within:text-dark-gunmetal"
                  >
                    <mat-icon aria-label="surname icon">person_add</mat-icon>
                  </div>
                </div>
                <p
                  *ngIf="
                    userForm.get('surname')?.errors &&
                    (userForm.get('surname')?.touched ||
                      userForm.get('surname')?.dirty)
                  "
                  class="absolute w-full text-red-500 text-xs text-center font-medium mt-1 h-5"
                >
                  {{ getErrorMessage('surname') }}
                </p>
              </div>

              <div class="relative">
                <label
                  class="text-gray-800 font-semibold text-sm block"
                  for="email"
                >
                  {{ 'input.email.label' | translate }}
                </label>
                <div class="relative flex items-center group">
                  <input
                    id="email"
                    formControlName="email"
                    type="text"
                    class="w-full bg-transparent text-sm border-b border-gray-300 focus:border-dark-gunmetal px-2 py-3 outline-none"
                    placeholder="{{ 'input.email.placeholder' | translate }}"
                  />
                  <div
                    class="w-[18px] h-[18px] absolute right-4 text-gray-300 group-focus-within:text-dark-gunmetal"
                  >
                    <mat-icon aria-label="Email icon">email</mat-icon>
                  </div>
                </div>
                <p
                  *ngIf="
                    userForm.get('email')?.errors &&
                    (userForm.get('email')?.touched ||
                      userForm.get('email')?.dirty)
                  "
                  class="absolute w-full text-red-500 text-xs text-center font-medium mt-1 h-5"
                >
                  {{ getErrorMessage('email') }}
                </p>
              </div>

              <div class="relative">
                <label
                  class="text-gray-800 font-semibold text-sm block"
                  for="username"
                >
                  {{ 'input.username.label' | translate }}
                </label>
                <div class="relative flex items-center group">
                  <input
                    id="username"
                    formControlName="username"
                    type="text"
                    class="w-full bg-transparent text-sm border-b border-gray-300 focus:border-dark-gunmetal px-2 py-3 outline-none"
                    placeholder="{{ 'input.username.placeholder' | translate }}"
                  />
                  <div
                    class="w-[18px] h-[18px] absolute right-4 text-gray-300 group-focus-within:text-dark-gunmetal"
                  >
                    <mat-icon aria-label="username icon">badge</mat-icon>
                  </div>
                </div>
                <p
                  *ngIf="
                    userForm.get('username')?.errors &&
                    (userForm.get('username')?.touched ||
                      userForm.get('username')?.dirty)
                  "
                  class="absolute w-full text-red-500 text-xs text-center font-medium mt-1 h-5"
                >
                  {{ getErrorMessage('username') }}
                </p>
              </div>
              <div *ngIf="isEditable" class="relative">
                <label
                  class="text-gray-800 font-semibold text-sm block"
                  for="idProfile"
                >
                  {{ 'input.profile.label' | translate }}
                </label>
                <div class="relative flex items-center group">
                  <select
                    id="idProfile"
                    formControlName="idProfile"
                    (change)="handlerProfileChange($event)"
                    class="w-full bg-transparent text-sm border-b border-gray-300 focus:border-dark-gunmetal px-2 py-3 outline-none"
                  >
                    <option disabled selected value="">
                      {{ 'input.profile.placeholder' | translate }}
                    </option>

                    <option
                      *ngFor="let profile of profiles"
                      [value]="profile.idProfile"
                    >
                      {{ profile.name }}
                    </option>
                  </select>
                  <div
                    class="w-[18px] h-[18px] absolute right-4 text-gray-300 group-focus-within:text-dark-gunmetal"
                  >
                    <mat-icon aria-label="role icon"
                      >supervisor_account</mat-icon
                    >
                  </div>
                </div>
                <p
                  *ngIf="
                    userForm.get('profile')?.errors &&
                    (userForm.get('profile')?.touched ||
                      userForm.get('profile')?.dirty)
                  "
                  class="absolute w-full text-red-500 text-xs text-center font-medium mt-1 h-5"
                >
                  {{ getErrorMessage('profile') }}
                </p>
              </div>
              <div
                [ngClass]="{
                  'mt-4': !isEditable
                }"
                class="content-end flex justify-center items-end gap-4"
              >
                <button
                  (click)="clearForm()"
                  type="button"
                  class="p-6 inline-flex justify-center items-center text-sm w-full h-10 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded transition-all"
                >
                  Cancel
                </button>
                <button
                  [disabled]="userForm.invalid"
                  [ngClass]="{
                    'opacity-60 cursor-not-allowed': userForm.invalid,
                    'active:scale-95 hover:bg-sunset-orange-600': userForm.valid
                  }"
                  type="submit"
                  class="p-6 inline-flex justify-center items-center h-10 text-sm w-full bg-sunset-orange-500 rounded-md text-white focus:outline-none transition-colors duration-300 ease-in-out"
                >
                  {{
                    isEditable
                      ? ('button.update' | translate)
                      : ('button.create' | translate)
                  }}
                </button>
              </div>
            </div>
          </div>
        </form>
      </div>

      <div
        class="flex-1 overflow-x-auto rounded-lg shadow-[0_2px_10px_rgba(0,0,0,0.1)]"
      >
        <div class="min-w-full inline-block align-middle h-full">
          <div
            class="overflow-hidden border rounded-lg bg-white border-gray-300 h-full flex flex-col"
          >
            <div class="overflow-y-auto flex-1">
              <table class="min-w-full">
                <thead class="sticky top-0 bg-dark-gunmetal">
                  <tr>
                    <th
                      class="p-5 text-center text-sm leading-6 font-semibold text-light-gray capitalize"
                    >
                      {{ 'audit.data.id' | translate }}
                    </th>
                    <th
                      class="p-5 text-center text-sm leading-6 font-semibold text-light-gray capitalize"
                    >
                      {{ 'audit.data.email' | translate }}
                    </th>
                    <th
                      class="p-5 text-center text-sm leading-6 font-semibold text-light-gray capitalize"
                    >
                      {{ 'audit.data.date' | translate }}
                    </th>
                    <th
                      class="p-5 text-center text-sm leading-6 font-semibold text-light-gray capitalize"
                    >
                      {{ 'audit.data.entity' | translate }}
                    </th>
                    <th
                      class="p-5 text-center text-sm leading-6 font-semibold text-light-gray capitalize"
                    >
                      {{ 'audit.data.http_method' | translate }}
                    </th>
                    <th
                      class="p-5 text-center text-sm leading-6 font-semibold text-light-gray capitalize"
                    >
                      {{ 'audit.data.details' | translate }}
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <tr
                    *ngFor="let audit of audits; let i = index"
                    class="odd:bg-gray-100 even:bg-white"
                  >
                    <td
                      class="p-5 text-center whitespace-nowrap text-sm leading-6 font-medium text-gray-900 border-r border-gray-300"
                    ></td>
                    <td
                      class="p-5 text-center whitespace-nowrap text-sm leading-6 font-medium text-gray-900 border-r border-gray-300"
                    >
                      {{ audit.email }}
                    </td>
                    <td
                      class="p-5 text-center whitespace-nowrap text-sm leading-6 font-medium text-gray-900 border-r border-gray-300"
                    >
                      {{ audit.date_operation | dateFormat }}
                    </td>
                    <td
                      class="p-5 text-center whitespace-nowrap text-sm leading-6 font-medium text-gray-900 border-r border-gray-300"
                    >
                      {{ audit.entity }}
                    </td>
                    <td
                      class="p-5 text-center whitespace-nowrap text-sm leading-6 font-black text-gray-900 border-r border-gray-300"
                    ></td>
                    <td
                      class="p-5 text-center whitespace-nowrap text-sm leading-6 font-medium text-gray-900 border-r border-gray-300"
                    ></td>
                  </tr>
                </tbody>
              </table>
            </div>
            <mat-paginator
              class="w-full mt-auto"
              [hidePageSize]="true"
              [length]="100"
              [pageSize]="10"
            >
            </mat-paginator>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
